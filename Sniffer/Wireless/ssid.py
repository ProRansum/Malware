import sys
from scapy.all import *


ssid = set()
count = 0

def PacketHandler(packet):
	if packet.haslayer(Dot11Beacon):
		if packet.info and (packet.info not in ssid):
			global count
			
			ssid.add(packet.info)
			count = count + 1
			
			print("%i\t%s\t%s\n" % (count, packet.info, packet.addr3))
		else:
			pass
	
	else:
		pass	


print("S.No\tSSID\tBSSID\n")
sniff(iface=sys.argv[1], count=int(sys.argv[2]), prn=PacketHandler)
