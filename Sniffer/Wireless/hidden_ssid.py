import sys
from scapy.all import *



# find beacons with lengths of 0 and monitor probe responses to resolve ssid name
hiddenssid = set()
name = set()

def PacketHandler(packet):
	
	if packet.haslayer(Dot11Beacon):
		if len(packet.info) == 0:
			if packet.addr3 not in hiddenssid:
				print("Found Hidden SSID: %s" % packet.addr3)
				hiddenssid.add(packet.addr3)
	
	elif packet.haslayer(Dot11ProbeResp) and (packet.addr3 in hiddenssid):
		if packet.info not in name:
			print("Hidden SSID Details: %s\t%s" % (packet.addr3, packet.info))
			name.add(packet.info)


sniff(iface=sys.argv[1], count=int(sys.argv[2]), prn=PacketHandler)
